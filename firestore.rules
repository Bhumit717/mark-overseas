rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    /**
     * üõ°Ô∏è PORTABLE DOMAIN SECURITY
     * ---------------------------
     * IMPORTANT: Firestore Rules cannot see the 'Domain' of the request.
     * To secure your database, you MUST add your domains in the Firebase Console:
     * Authentication -> Settings -> Authorized Domains.
     *
     * AUTHORIZED DOMAINS TO ADD:
     * 1. mark-overseas.com
     * 2. www.mark-overseas.com
     * 3. mark-overseas.vercel.app
     * 4. [Your Custom Domain]
     */
    
    // üõ°Ô∏è REAL DOMAIN SECURITY
    // This rule REJECTS any data that doesn't belong to your domains.
    match /inquiry_vault/{pwd}/data/{id} {
      
      allow create: if pwd == 'Mark@Overseas321' && 
        (request.resource.data.authorizedDomain.lower() in [
          'https://mark-overseas.com', 
          'https://www.mark-overseas.com', 
          'https://mark-overseas.vercel.app'
        ]);

      // Read/Delete restricted to the secret path
      allow read, delete: if pwd == 'Mark@Overseas321';
    }

    // Default: Deny EVERYTHING else
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
