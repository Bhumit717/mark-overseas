rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    function isAllowedDomain() {
      return request.resource.data.authorizedDomain in [
        'https://mark-overseas.com',
        'https://www.mark-overseas.com',
        'https://mark-overseas.vercel.app',
        'https://www.mark-overseas.vercel.app'
      ];
    }

    function correctPassword(pwd) {
      // ðŸ”‘ The Master Key for the Admin
      return pwd == 'Mark_Vault'; 
    }

    match /inquiry_vault/{pwd}/data/{id} {

      // âœ… ADD DETAILS â†’ ONLY DOMAIN REQUIRED
      allow create: if isAllowedDomain();

      // âœ… READ / DELETE â†’ DOMAIN + PASSWORD REQUIRED
      allow read, delete: if correctPassword(pwd)
                          && resource.data.authorizedDomain in [
                            'https://mark-overseas.com',
                            'https://www.mark-overseas.com',
                            'https://mark-overseas.vercel.app',
                            'https://www.mark-overseas.vercel.app'
                          ];
    }

    match /{document=**} {
      allow read, write: if false;
    }
  }
}
