rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // üõ°Ô∏è ENFORCED FIREBASE AUTH SECURITY
    // No passwords in code. Access is tied to your Google/Firebase Account.
    match /inquiries/{inquiryId} {
      
      // Allow creation only if it contains the authorizedDomain (Layer 2 Security)
      allow create: if request.resource.data.authorizedDomain.lower() in [
          'https://mark-overseas.com', 
          'https://www.mark-overseas.com', 
          'https://mark-overseas.vercel.app'
        ];

      // Access is ONLY granted to your specific admin email.
      // Even if a hacker has your config, they CANNOT login without your Google account.
      allow read, delete: if request.auth != null && request.auth.token.email == 'markoverseas28@gmail.com'; 
    }

    // Default: Deny EVERYTHING else
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
